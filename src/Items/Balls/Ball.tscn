[gd_scene load_steps=24 format=2]

[ext_resource path="res://assets/art/ball/ball_selection.png" type="Texture" id=1]
[ext_resource path="res://src/Items/Balls/Ball.gd" type="Script" id=2]
[ext_resource path="res://assets/art/ball/ball_test.png" type="Texture" id=3]
[ext_resource path="res://assets/art/effects/trail.png" type="Texture" id=4]
[ext_resource path="res://src/Effects/DustParticle.tscn" type="PackedScene" id=5]
[ext_resource path="res://src/Effects/TrailHandler.tscn" type="PackedScene" id=6]
[ext_resource path="res://src/Items/Balls/BallEffectsHandler.gd" type="Script" id=7]

[sub_resource type="CircleShape2D" id=1]
resource_local_to_scene = true
radius = 6.0

[sub_resource type="GDScript" id=2]
script/source = "extends Area2D
#Selector
onready var ball = get_parent()
export (bool) var selected = false
export (Color) var selection_color = Color(1.0,1.0,0.7) #setget set_selection_color
var selection_color_mid = Color(selection_color.r*0.5, selection_color.g*0.5, selection_color.b*0.5)

onready var selection_sprite = ball.get_node(\"Sprite/Sprite_Selection\")

# Called when the node enters the scene tree for the first time.
func _ready():
	#connect(\"mouse_entered\", self, \"_on_Selector_mouse_entered\")
	#connect(\"mouse_exited\", self, \"_on_Selector_mouse_exited\")
	pass

func set_selection_color(col):
	selection_sprite.modulate = col

func toggle_selection(b):
	selected = b
	if selected :
		set_selection_color(selection_color)
		selection_sprite.visible = true
	else :
		selection_sprite.visible = false

func _on_Selector_mouse_entered():
	if !selected:
		set_selection_color(selection_color_mid)
		selection_sprite.visible = true
	Global.mouse_ball = ball

func _on_Selector_mouse_exited():
	if !selected:
		selection_sprite.visible = false
	if Global.mouse_ball == ball:
		Global.mouse_ball = null
"

[sub_resource type="CircleShape2D" id=3]
radius = 16.0

[sub_resource type="Animation" id=4]
resource_name = "destruction"
length = 0.5
tracks/0/type = "method"
tracks/0/path = NodePath("Effects/Destruction")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/keys = {
"times": PoolRealArray( 0 ),
"transitions": PoolRealArray( 1 ),
"values": [ {
"args": [  ],
"method": "restart"
} ]
}
tracks/1/type = "value"
tracks/1/path = NodePath("Effects/Destruction:emitting")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/keys = {
"times": PoolRealArray( 0 ),
"transitions": PoolRealArray( 1 ),
"update": 1,
"values": [ true ]
}
tracks/2/type = "value"
tracks/2/path = NodePath("Sprite:modulate")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/keys = {
"times": PoolRealArray( 0, 0.2 ),
"transitions": PoolRealArray( 1, 1 ),
"update": 0,
"values": [ Color( 1, 1, 1, 1 ), Color( 1, 1, 1, 0 ) ]
}
tracks/3/type = "method"
tracks/3/path = NodePath(".")
tracks/3/interp = 1
tracks/3/loop_wrap = true
tracks/3/imported = false
tracks/3/enabled = true
tracks/3/keys = {
"times": PoolRealArray( 0.5 ),
"transitions": PoolRealArray( 1 ),
"values": [ {
"args": [  ],
"method": "queue_free"
} ]
}

[sub_resource type="Animation" id=5]
length = 1.4
tracks/0/type = "method"
tracks/0/path = NodePath("Effects/Reconstruction")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/keys = {
"times": PoolRealArray( 0.9 ),
"transitions": PoolRealArray( 1 ),
"values": [ {
"args": [  ],
"method": "restart"
} ]
}
tracks/1/type = "value"
tracks/1/path = NodePath("Effects/Reconstruction:emitting")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/keys = {
"times": PoolRealArray( 0.9 ),
"transitions": PoolRealArray( 1 ),
"update": 1,
"values": [ true ]
}
tracks/2/type = "method"
tracks/2/path = NodePath("Effects/DunkParticles")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/keys = {
"times": PoolRealArray( 0.35 ),
"transitions": PoolRealArray( 1 ),
"values": [ {
"args": [  ],
"method": "restart"
} ]
}
tracks/3/type = "value"
tracks/3/path = NodePath("Effects/DunkParticles:emitting")
tracks/3/interp = 1
tracks/3/loop_wrap = true
tracks/3/imported = false
tracks/3/enabled = true
tracks/3/keys = {
"times": PoolRealArray( 0.35 ),
"transitions": PoolRealArray( 1 ),
"update": 1,
"values": [ true ]
}
tracks/4/type = "value"
tracks/4/path = NodePath("Sprite:modulate")
tracks/4/interp = 1
tracks/4/loop_wrap = true
tracks/4/imported = false
tracks/4/enabled = true
tracks/4/keys = {
"times": PoolRealArray( 0.3, 0.5, 1.2, 1.4 ),
"transitions": PoolRealArray( 1, 1, 1, 1 ),
"update": 0,
"values": [ Color( 1, 1, 1, 1 ), Color( 1, 1, 1, 0 ), Color( 1, 1, 1, 0 ), Color( 1, 1, 1, 1 ) ]
}

[sub_resource type="StreamTexture" id=6]
load_path = "res://.import/round.png-173de128c3ea8d3b72416bcc5f522248.stex"

[sub_resource type="Curve" id=7]
_data = [ Vector2( 0, 0.0886364 ), 0.0, 0.215584, 0, 0, Vector2( 0.554217, 0.952273 ), 0.425641, 0.425641, 0, 0, Vector2( 1, 1 ), -0.570101, 0.0, 0, 0 ]

[sub_resource type="Gradient" id=8]
resource_local_to_scene = true
offsets = PoolRealArray( 0, 0.00699301, 0.244755, 0.468531, 0.839161, 1 )
colors = PoolColorArray( 1, 0, 0.580392, 0, 0, 0, 0, 0.258741, 0.535156, 0.535156, 0.535156, 0.705882, 0.839844, 0.839844, 0.839844, 1, 1, 1, 1, 1, 1, 1, 1, 0 )

[sub_resource type="StreamTexture" id=9]
load_path = "res://.import/round.png-173de128c3ea8d3b72416bcc5f522248.stex"

[sub_resource type="Curve" id=10]
_data = [ Vector2( 0, 1 ), 0.0, 0.215584, 0, 0, Vector2( 0.581967, 1 ), -1.3517, -1.3517, 0, 0, Vector2( 1, 0.238636 ), -0.570101, 0.0, 0, 0 ]

[sub_resource type="Gradient" id=11]
resource_local_to_scene = true
offsets = PoolRealArray( 0, 0.020202, 0.131313, 0.50505, 0.808081, 1 )
colors = PoolColorArray( 1, 0, 0.580392, 0, 1, 1, 1, 0, 1, 1, 1, 1, 0.839844, 0.839844, 0.839844, 1, 0.533333, 0.533333, 0.533333, 0.705882, 0, 0, 0, 0.258824 )

[sub_resource type="StreamTexture" id=12]
load_path = "res://.import/round.png-173de128c3ea8d3b72416bcc5f522248.stex"

[sub_resource type="Curve" id=13]
_data = [ Vector2( 0, 0.784091 ), 0.0, 3.55714, 0, 0, Vector2( 1, 0 ), 0.0, 0.0, 0, 0 ]

[sub_resource type="Gradient" id=14]
offsets = PoolRealArray( 0.020979, 0.27972, 0.75, 1 )
colors = PoolColorArray( 1, 0.954956, 0.859375, 0, 0.820312, 0.799805, 0.78186, 1, 0.538086, 0.369934, 0.475029, 0.34, 0.129412, 0.0705882, 0.172549, 0 )

[sub_resource type="Gradient" id=15]
offsets = PoolRealArray( 0.0344828, 0.517241, 1 )
colors = PoolColorArray( 1, 0, 0.585938, 0, 0.698039, 0.239216, 0.133333, 0.486275, 1, 0, 0, 1 )

[sub_resource type="Curve" id=16]
_data = [ Vector2( 0, 0 ), 0.0, 0.0, 0, 0, Vector2( 1, 1 ), 0.0, 0.0, 0, 0 ]

[node name="Ball" type="KinematicBody2D"]
light_mask = 4
z_index = 11
z_as_relative = false
input_pickable = true
collision_layer = 4
collision_mask = 6
script = ExtResource( 2 )
__meta__ = {
"_edit_group_": true
}

[node name="Sprite" type="Sprite" parent="."]
light_mask = 4
texture = ExtResource( 3 )

[node name="Sprite_Selection" type="Sprite" parent="Sprite"]
visible = false
modulate = Color( 0.980392, 0.803922, 0.498039, 1 )
texture = ExtResource( 1 )

[node name="collision" type="CollisionShape2D" parent="."]
visible = false
shape = SubResource( 1 )

[node name="Selector" type="Area2D" parent="."]
script = SubResource( 2 )

[node name="CollisionShape2D" type="CollisionShape2D" parent="Selector"]
visible = false
shape = SubResource( 3 )

[node name="Animation" type="AnimationPlayer" parent="."]
anims/destruction = SubResource( 4 )
anims/dunk = SubResource( 5 )

[node name="Effects" type="Node2D" parent="."]
script = ExtResource( 7 )
col1 = Color( 0.866667, 0.866667, 0.866667, 1 )
col2 = Color( 0.505882, 0.517647, 0.521569, 1 )
col3 = Color( 0.317647, 0.333333, 0.345098, 1 )

[node name="Reconstruction" type="CPUParticles2D" parent="Effects"]
emitting = false
amount = 24
lifetime = 0.6
one_shot = true
speed_scale = 1.5
explosiveness = 0.61
lifetime_randomness = 0.29
fract_delta = false
texture = SubResource( 6 )
emission_shape = 3
emission_points = PoolVector2Array( 0, 16, 0, -16, 16, 0, -16, 0, 11.3, 11.3, -11.3, -11.3, 11.3, -11.3, -11.3, 11.3 )
emission_colors = PoolColorArray(  )
direction = Vector2( 0, 0 )
spread = 180.0
gravity = Vector2( 0, 0 )
orbit_velocity = 0.3
radial_accel = -250.0
damping = 100.0
scale_amount = 0.03
scale_amount_random = 0.04
scale_amount_curve = SubResource( 7 )
color_ramp = SubResource( 8 )
__meta__ = {
"_editor_description_": ""
}

[node name="Destruction" type="CPUParticles2D" parent="Effects"]
emitting = false
amount = 24
lifetime = 0.6
one_shot = true
speed_scale = 1.5
explosiveness = 0.8
lifetime_randomness = 0.29
fract_delta = false
texture = SubResource( 9 )
emission_shape = 3
emission_points = PoolVector2Array( 0, 1, 0, -1, 1, 0, -1, 0, 1, 1, -1, -1, 1, -1, -1, 1 )
emission_colors = PoolColorArray(  )
direction = Vector2( 0, 0 )
spread = 180.0
gravity = Vector2( 0, 0 )
orbit_velocity = -0.5
radial_accel = 250.0
damping = 100.0
scale_amount = 0.06
scale_amount_curve = SubResource( 10 )
color_ramp = SubResource( 11 )
__meta__ = {
"_editor_description_": ""
}

[node name="DunkParticles" type="CPUParticles2D" parent="Effects"]
position = Vector2( 0, -3.8147e-06 )
z_index = 99
z_as_relative = false
emitting = false
amount = 50
one_shot = true
explosiveness = 0.7
randomness = 0.05
lifetime_randomness = 0.29
fract_delta = false
local_coords = false
texture = SubResource( 12 )
direction = Vector2( 0, 0 )
spread = 180.0
gravity = Vector2( 0, -100 )
initial_velocity = 50.0
initial_velocity_random = 0.71
linear_accel = -20.0
tangential_accel = -0.69
damping = 100.0
damping_random = 0.68
scale_amount = 0.06
scale_amount_random = 0.04
scale_amount_curve = SubResource( 13 )
color_ramp = SubResource( 14 )
__meta__ = {
"_editor_description_": ""
}

[node name="DustParticle" parent="Effects" instance=ExtResource( 5 )]
z_index = -1
amount = 10
initial_velocity = 45.0

[node name="TrailHandler" parent="Effects" instance=ExtResource( 6 )]
wildness = 30.0
gravity = Vector2( 0, 0 )
gradient_col = SubResource( 15 )
width_curve = SubResource( 16 )
texture = ExtResource( 4 )

[connection signal="mouse_entered" from="Selector" to="Selector" method="_on_Selector_mouse_entered"]
[connection signal="mouse_exited" from="Selector" to="Selector" method="_on_Selector_mouse_exited"]
